# ğŸš«next SSR ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯

[https://gyazo.com/0eea9b5cfe9029af2cc3ba77e2d6e19c]

Nuxt.js ã§ SSR ã‚’ä½¿ã†å ´åˆã¯ã€

åˆå›ã®æç”»æ™‚ã®ã¿ SSR
ãã‚Œä»¥é™ã¯ CSR

[https://gyazo.com/fb3a9487270c9f4f869f1c3b65169609]

â†“ ã“ã£ã¡ã®ï½ˆ
[https://gyazo.com/c6c893a5e852b3604533502498675fcb]

ã€SSR ã¨ CSR ã®å®Ÿè¡Œé †åºã€‘
ã€Œå®Ÿéš›ã®ä¾‹ã‚³ãƒ¼ãƒ‰ã€

````<template>

  <div>
    <h1>SAMPLE</h1>
    <nuxt-link to="/blue">ãƒªãƒ³ã‚¯</nuxt-link>
  </div>
</template>

<script>
export default {
  layout: 'top',
  data() {
    console.log('data / server: ' + process.server)
    return {
      value: ''
    }
  },
  asyncData() {
    console.log('asyncData / server: ' + process.server)
  },
  fetch() {
    console.log('fetch / server: ' + process.server)
  },
  beforeCreate() {
    console.log('beforeCreate / server: ' + process.server)
  },
  created() {
    console.log('created / server: ' + process.server)
  },
  beforeMount() {
    console.log('beforeMount / server: ' + process.server)
  },
  mounted() {
    console.log('mounted / server: ' + process.server)
  }
}
</script>```

ã€Œå®Ÿè¡Œçµæœã€
(SSR) asyncData
(SSR) beforeCreate _
(SSR) data _
(SSR) created \*
(SSR) fetch

(CSR) beforeCreate _
(CSR) data _
(CSR) created _
(CSR) beforeMount
(CSR) mounted
â†’ åˆå›æç”»æ™‚ã¯ã€SSR -> CSR ã¨ã„ã†é †ç•ªã§ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ•ãƒƒã‚¯ãŒå®Ÿè¡Œã•ã‚Œã€
beforeCreate data created(_)ã¯ã©ã¡ã‚‰ã§ã‚‚å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚
â€»data ã®ãªã‹ã§é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼åã

ã€asyncData fetchã€‘
ãƒ»asyncData()
â†’ ãƒšãƒ¼ã‚¸ãŒãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹å‰ï¼ˆVue ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒä½œæˆã•ã‚Œã‚‹å‰ï¼‰ã«å‘¼ã³å‡ºã•ã‚Œã‚‹é–¢æ•°ã§ã€é€šå¸¸ API å‘¼ã³å‡ºã—ãªã©ã®éåŒæœŸå‡¦ç†ã‚’è¨˜è¿°ã™ã‚‹ã€‚çµæœã¯ Vue ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã® data ã¨ãƒãƒ¼ã‚¸ã•ã‚Œã€åŒã˜ã‚­ãƒ¼ãŒå­˜åœ¨ã™ã‚‹å ´åˆã¯ asyncData ã®çµæœã§ä¸Šæ›¸ãã•ã‚Œã‚‹
â†’Page ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’å–ã‚Šè¾¼ã‚€ãŸã‚ã«ä½¿ç”¨ï¼ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã™ã¨ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã®å‰ã«ãƒ‡ãƒ¼ã‚¿ã®å‡ºåŠ›ã¨ãƒãƒ¼ã‚¸ã•ã‚Œã‚‹
â€»asyncData ãƒ¡ã‚½ãƒƒãƒ‰å†…ã® this ã‚’é€šã—ã¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ã¯ ã§ããªã„ã€‚ãã‚Œã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã•ã‚Œã‚‹å‰ã« ã“ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã‹ã‚‰

ãƒ»fetch()
â†’asyncData ã¨åŒæ§˜ã€ãƒšãƒ¼ã‚¸ãŒãƒ­ãƒ¼ãƒ‰ã•ã‚Œã‚‹å‰ã«å‘¼ã³å‡ºã•ã‚Œã€éåŒæœŸå‡¦ç†ã‚’è¨˜è¿°ã™ã‚‹ãŸã‚ã®é–¢æ•°ã€‚
asyncData ã¨ã®é•ã„ã¯ã€çµæœã‚’ Vue ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã® data ã¨ãƒãƒ¼ã‚¸ã—ãªã„ã¨ã„ã†ç‚¹
â†’Vuex Store ã‚’ä½œæˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ï¼ˆãƒ—ãƒ­ãƒŸã‚¹ã‚’è¿”ã™ã¨ã€Nuxt ã¯ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹å‰ã«ãƒ—ãƒ­ãƒŸã‚¹ãŒè§£æ±ºã•ã‚Œã‚‹ã¾ã§å¾…æ©Ÿã™ã‚‹
ï¼ˆâ€»Vue ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼ˆã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ï¼‰ã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ï¼‰â†’vuex ã®ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¨ã¯æ„å‘³ãŒé•ã†ã¯ãšï¼Ÿï¼‰

asyncData ã¨ã®é•ã„ã«ã‚‚æ›¸ãã¾ã—ãŸãŒ
API é€šä¿¡ã®çµæœã‚’ Vuex ã® store ã«æ ¼ç´ã™ã‚‹ã‚‚ã®ã§ã™ ğŸ§¸
â€»this ãŒä½¿ãˆãªã„
this ã‚’é€šã—ã¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«
ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ ğŸ’¥

ä½¿ç”¨ç®‡æ‰€
pages å†…ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã¿ä½¿ç”¨å¯èƒ½

â€»asyncDataï¼šã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆå‰
fetchï¼šã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆå¾Œ

9/9
ãŸã¶ã‚“ã€ayncsData ã¯ SSR ãªã®ã§ã€æ™®é€šã«è¨˜è¿°ã—ã¦ã‚‚ãƒ‡ãƒ¼ã‚¿ã¨ã‹ã¯ã¨ã£ã¦ã“ã‚Œãªã„
ã‚ˆãã‚ã‚‹ä¾‹ã ã¨ã€axios ã‚’åˆ©ç”¨ã—ã¦ http é€šä¿¡ã‚’è¡Œã£ã¦ API ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¦ã„ã‚‹

ãƒ»Nuxt.js ã® asyncData ã¨ fetch ã¯ä½•ãŒé•ã†ã®ã‹
https://qiita.com/Tsuyoshi84/items/2e47b7f5e7fb8c0c3c66

ã€æ¤œè¨äº‹é …ã€‘
ç’°å¢ƒä¾å­˜ã®ãªã„å‡¦ç†ã¯ã€ä¸€åº¦ã—ã‹å®Ÿè¡Œã•ã‚Œãªã„ã“ã¨ã‚’ä¿è¨¼ã—ã¦ãã‚Œã‚‹ asyncData ã‚„ fetch ã«è¨˜è¿°ã™ã‚‹ã®ãŒã‚»ã‚ªãƒªãƒ¼
â†’localStorage ã‚„ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ã•ã‚ŒãŸèªè¨¼æƒ…å ±ã‚’åˆ©ç”¨ã™ã‚‹ã‚µãƒ¼ãƒ‰ãƒ‘ãƒ¼ãƒ†ã‚£ API ã®ã‚ˆã†ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã§ã—ã‹å®Ÿè¡Œã§ããªã„å‡¦ç†ã¯ã€å¿…ãšã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã§å®Ÿè¡Œã•ã‚Œã‚‹ created ã‚„ mounted ã§è¨˜è¿°ã™ã‚‹å¿…è¦ãŒã‚ã‚‹

ï¼‘ï¼ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã¯ã©ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ï¼ˆSSRorCSRï¼‰ã§ç™ºç«ã™ã‚‹ã‹
ï¼’ï¼ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹èª­ã¿è¾¼ã¿ã¯ created ã§ã„ã„ã‹ï¼ŸSSR ã§ã‚„ã£ãŸã‚‰é€Ÿåº¦ä¸ŠãŒã‚‹ï¼Ÿ

ã€ã¾ã¨ã‚ã€‘
ãƒ»åˆå›æç”»æ™‚ã®ã¿ SSRã€ãã‚Œä»¥é™ã¯ CSR
ãƒ»åˆå›æç”»æ™‚ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã¯ã€asyncData -> beforeCreate _ -> data _ -> created * -> fetch -> beforeMount -> mounted
(*SSR ã§ã‚‚ CSR ã§ã‚‚å®Ÿè¡Œã•ã‚Œã‚‹)
ãƒ»window ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ DOM ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã®ã¯ã€beforeMount ä»¥é™ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒãƒã‚¦ãƒ³ãƒˆã•ã‚ŒãŸå¾Œ(ãƒ‡ã‚£ãƒ¬ã‚¯ãƒ†ã‚£ãƒ–ã‚„ãƒ ã‚¹ã‚¿ã‚·ã‚§)ãªã‚‰ mounted
ãƒ»Nuxt.js ã§ SSR ã‚’ä½¿ã†æ™‚ã¯ã€SSR ã¨ CSR ã©ã¡ã‚‰ã§ã‚‚å‹•ä½œã™ã‚‹ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ«ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãå¿…è¦ãŒã‚ã‚‹
ã€å‚è€ƒæ–‡çŒ®ã€‘
ãƒ»Nuxt.js ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«è¦šæ›¸
http://lab.astamuse.co.jp/entry/2019/05/29/114500
ãƒ»Vue.js ã¨ Nuxt.js ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«æ—©å¼•ããƒ¡ãƒ¢
https://qiita.com/japboy/items/b67bae0bac1aeefb2680
ãƒ»Nuxt.js ï½œ SSR ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«
https://koz2020.hatenablog.com/entry/2020/05/10/085120
ãƒ»Vue.js ã® SSR ã§ã¯ created ãŒ 2 å›å®Ÿè¡Œã•ã‚Œã‚‹!?
https://medium.com/veltra-engineering/in-ssr-vue-js-is-created-twice-7f9122de9b77
````
